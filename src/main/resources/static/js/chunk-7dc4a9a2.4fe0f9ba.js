(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dc4a9a2"],{"267c":function(e,t,i){var n={"./OrgManage.vue":"bf1f"};function a(e){var t=d(e);return i(t)}function d(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=d,e.exports=a,a.id="267c"},"4de4":function(e,t,i){"use strict";var n=i("23e7"),a=i("b727").filter,d=i("1dde"),o=i("ae40"),l=d("filter"),s=o("filter");n({target:"Array",proto:!0,forced:!l||!s},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},bf1f:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"500px"}},[i("el-input",{attrs:{placeholder:"请输入部门名称进行搜索...","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),i("div",{staticClass:"organization-tree"},[i("el-tree",{ref:"tree",attrs:{data:e.deps,props:e.defaultProps,"expand-on-click-node":!1,"filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var n=t.data;return i("span",{staticClass:"custom-tree-node",staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("span",[e._v(e._s(n.depname)+"(领导: "+e._s(n.leadername)+")")]),i("span",[i("el-button",{staticClass:"depBtn",attrs:{type:"info",size:"mini"},on:{click:function(){return e.showUpdateDepView(n)}}},[e._v(" 修改 ")]),i("el-button",{staticClass:"depBtn",attrs:{type:"primary",size:"mini"},on:{click:function(){return e.showAddDepView(n)}}},[e._v(" 添加 ")]),i("el-button",{staticClass:"depBtn",attrs:{type:"danger",size:"mini"},on:{click:function(){return e.deleteDep(n)}}},[e._v(" 删除 ")])],1)])}}])}),i("el-dialog",{attrs:{title:"修改部门",visible:e.updateDialogVisible,width:"30%"},on:{"update:visible":function(t){e.updateDialogVisible=t}}},[i("div",[i("table",[i("tr",[i("td",[i("el-tag",[e._v("部门名称")])],1),i("td",[i("el-input",{attrs:{placeholder:"请输入部门名称..."},model:{value:e.dep.depname,callback:function(t){e.$set(e.dep,"depname",t)},expression:"dep.depname"}})],1)]),i("tr",[i("td",[i("el-tag",[e._v("领导工号")])],1),i("td",[i("el-select",{staticClass:"findAllEmp-autocomplete",attrs:{"popper-append-to-body":!1,clearable:"",filterable:"",placeholder:"请选择领导姓名"},model:{value:e.dep.leaderid,callback:function(t){e.$set(e.dep,"leaderid",t)},expression:"dep.leaderid"}},e._l(e.employees,(function(t){return i("el-option",{key:t.workid,attrs:{label:t.label,value:t.workid}},[i("div",{staticClass:"empname"},[e._v(e._s(t.label))]),i("span",{staticClass:"workid"},[e._v("工号: "+e._s(t.workid))])])})),1)],1)])])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.updateDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.doUpdateDep}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"添加部门",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[i("div",[i("table",[i("tr",[i("td",[i("el-tag",[e._v("上级部门")])],1),i("td",[e._v(e._s(e.pname))])]),i("tr",[i("td",[i("el-tag",[e._v("部门名称")])],1),i("td",[i("el-input",{attrs:{placeholder:"请输入部门名称..."},model:{value:e.dep.depname,callback:function(t){e.$set(e.dep,"depname",t)},expression:"dep.depname"}})],1)]),i("tr",[i("td",[i("el-tag",[e._v("领导姓名")])],1),i("td",[i("el-select",{staticClass:"findAllEmp-autocomplete",attrs:{"popper-append-to-body":!1,clearable:"",filterable:"",placeholder:"请选择领导姓名"},model:{value:e.dep.leaderid,callback:function(t){e.$set(e.dep,"leaderid",t)},expression:"dep.leaderid"}},e._l(e.employees,(function(t){return i("el-option",{key:t.workid,attrs:{label:t.label,value:t.workid}},[i("div",{staticClass:"empname"},[e._v(e._s(t.label))]),i("span",{staticClass:"workid"},[e._v("工号: "+e._s(t.workid))])])})),1)],1)])])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.doAddDep}},[e._v("确 定")])],1)])],1)],1)},a=[],d=(i("99af"),i("4de4"),i("c975"),i("a434"),{name:"OrgManage",data:function(){return{addDialogVisible:!1,updateDialogVisible:!1,filterText:"",dep:{depname:"",parentid:-1},pname:"",deps:[],defaultProps:{children:"children",label:"depname"},employees:[],state:""}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){this.initDeps()},methods:{initDep:function(){this.dep={depname:"",parentid:-1},this.pname=""},updateDep2Deps:function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.depid==t.depid)return void(n.leadername=t.leadername);this.updateDep2Deps(n.children,t)}},doUpdateDep:function(){var e=this;this.putRequest("/organization/management/update/",this.dep).then((function(t){t&&(e.updateDep2Deps(e.deps,t.obj),e.updateDialogVisible=!1,e.initDep())}))},addDep2Deps:function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.depid==t.parentid)return n.children=n.children.concat(t),void(n.children.length>0&&(n.parent=!0));this.addDep2Deps(n.children,t)}},doAddDep:function(){var e=this;this.postRequest("/organization/management/",this.dep).then((function(t){t&&(e.addDep2Deps(e.deps,t.obj),e.addDialogVisible=!1,e.initDep())}))},removeDepFromDeps:function(e,t,i){for(var n=0;n<t.length;n++){var a=t[n];if(a.depid==i)return t.splice(n,1),void(0==t.length&&(e.parent=!1));this.removeDepFromDeps(a,a.children,i)}},deleteDep:function(e){var t=this;e.parent?this.$message.error("父部门删除失败"):this.$confirm("此操作将永久删除【"+e.depname+"】部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRequest("/organization/management/"+e.depid).then((function(i){i&&t.removeDepFromDeps(null,t.deps,e.depid)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},showUpdateDepView:function(e){this.dep.depid=e.depid,this.dep.depname=e.depname,this.dep.parentid=e.parentid,this.updateDialogVisible=!0},showAddDepView:function(e){this.pname=e.depname,this.dep.parentid=e.depid,this.addDialogVisible=!0},initDeps:function(){var e=this;this.getRequest("/organization/management/").then((function(t){t&&(e.deps=t)})),this.getRequest("/organization/management/employee/").then((function(t){t&&(e.employees=t)}))},filterNode:function(e,t){return!e||-1!==t.depname.indexOf(e)}}}),o=d,l=(i("c6c1"),i("2877")),s=Object(l["a"])(o,n,a,!1,null,"6df43939",null);t["default"]=s.exports},c6c1:function(e,t,i){"use strict";var n=i("cca2"),a=i.n(n);a.a},cca2:function(e,t,i){}}]);
//# sourceMappingURL=chunk-7dc4a9a2.4fe0f9ba.js.map