(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e83db30a"],{2757:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div")},a=[],l={name:"WorkBench"},n=l,o=i("2877"),r=Object(o["a"])(n,s,a,!1,null,"84cc4ada",null);t["default"]=r.exports},"4de4":function(e,t,i){"use strict";var s=i("23e7"),a=i("b727").filter,l=i("1dde"),n=i("ae40"),o=l("filter"),r=n("filter");s({target:"Array",proto:!0,forced:!o||!r},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"63a5":function(e,t,i){},"7dcb":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticStyle:{"margin-top":"10px",display:"flex","justify-content":"center"}},[i("el-input",{staticStyle:{width:"400px","margin-right":"10px"},attrs:{placeholder:"通过员工姓名搜索用户...","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearch(t)}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.doSearch}},[e._v("搜索")]),i("el-button",{attrs:{type:"text"},on:{click:e.addUser}},[i("i",{staticClass:"fas fa-user-plus fa-lg"})])],1),i("div",{staticClass:"user-container"},e._l(e.users,(function(t,s){return i("el-card",{key:s,staticClass:"user-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v(e._s(t.employee.empname))]),i("el-button",{staticStyle:{float:"right",padding:"3px 0",color:"#e30007"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){return e.deleteUser(t)}}})],1),i("div",[i("div",{staticClass:"img-container"},[i("img",{staticClass:"userface-img",attrs:{src:t.userface,alt:t.employee.empname,title:t.employee.empname}})]),i("div",{staticClass:"userinfo-container"},[i("div",[e._v("用户工号："+e._s(t.workid))]),i("div",[e._v("系统账户："+e._s(t.username))]),i("div",[e._v("重置密码："),i("el-button",{staticStyle:{color:"black"},attrs:{type:"text"},on:{click:function(i){return e.resetpw(t)}}},[i("i",{staticClass:"fas fa-sync-alt"})])],1),i("div",[e._v("用户状态： "),i("el-switch",{attrs:{"active-text":"启用","active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"禁用"},on:{change:function(i){return e.enabledChange(t)}},model:{value:t.enabled,callback:function(i){e.$set(t,"enabled",i)},expression:"user.enabled"}})],1),i("div",[e._v("用户角色： "),e._l(t.roles,(function(t,s){return i("el-tag",{key:s,staticStyle:{"margin-right":"4px"},attrs:{type:"success"}},[e._v(e._s(t.zhname)+" ")])})),i("el-popover",{attrs:{placement:"right",title:"角色列表",width:"200",trigger:"click"},on:{show:function(i){return e.showPop(t)},hide:function(i){return e.hidePop(t)}}},[i("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.selectedRoles,callback:function(t){e.selectedRoles=t},expression:"selectedRoles"}},e._l(e.allroles,(function(e,t){return i("el-option",{key:t,attrs:{label:e.zhname,value:e.roleid}})})),1),i("el-button",{attrs:{slot:"reference",icon:"el-icon-more",type:"text"},slot:"reference"})],1)],2),i("div",{staticClass:"remark"},[e._v("备注："+e._s(t.userremark))])])])])})),1),i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("el-pagination",{attrs:{background:"","page-sizes":[8,24,56,80],layout:"sizes, prev, pager, next, jumper, ->, total, slot",total:e.total},on:{"current-change":e.currentChange,"size-change":e.sizeChange}})],1),i("el-dialog",{attrs:{title:"添加账户",visible:e.addUserDialogForm,width:"30%"},on:{"update:visible":function(t){e.addUserDialogForm=t}}},[i("el-form",{ref:"userForm",attrs:{model:e.user,"status-icon":"",rules:e.rules}},[i("el-form-item",{attrs:{label:"员工姓名: ",prop:"workid"}},[i("el-select",{staticClass:"findAllEmp-autocomplete",staticStyle:{width:"250px"},attrs:{"popper-append-to-body":!1,clearable:"",filterable:"",placeholder:"请选择领导姓名"},model:{value:e.user.workid,callback:function(t){e.$set(e.user,"workid",t)},expression:"user.workid"}},e._l(e.employees,(function(t){return i("el-option",{key:t.workid,attrs:{label:t.label,value:t.workid}},[i("div",{staticClass:"empname"},[e._v(e._s(t.label))]),i("span",{staticClass:"workid"},[e._v("工号: "+e._s(t.workid))])])})),1)],1),i("el-form-item",{attrs:{label:"员工账号: ",prop:"username"}},[i("el-input",{staticStyle:{width:"250px"},attrs:{clearable:"","prefix-icon":"el-icon-edit",placeholder:"请输入员工账号"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),i("el-form-item",{attrs:{label:"账户密码: ",prop:"password"}},[i("el-input",{staticStyle:{width:"250px"},attrs:{clearable:"","prefix-icon":"el-icon-key",type:"password","auto-complete":"off","show-password":"",placeholder:"请输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),i("el-form-item",{attrs:{label:"确认密码: ",prop:"checkPassword"}},[i("el-input",{staticStyle:{width:"250px"},attrs:{clearable:"","prefix-icon":"el-icon-key",type:"password",autocomplete:"off","show-password":"",placeholder:"请再次输入密码"},model:{value:e.user.checkPassword,callback:function(t){e.$set(e.user,"checkPassword",t)},expression:"user.checkPassword"}})],1),i("el-form-item",{attrs:{label:"账户状态: ",prop:"enabled"}},[i("el-switch",{attrs:{"active-text":"启用","active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"禁用"},model:{value:e.user.enabled,callback:function(t){e.$set(e.user,"enabled",t)},expression:"user.enabled"}})],1),i("el-form-item",{attrs:{label:"账户备注: ",prop:"userremark"}},[i("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:7},placeholder:"请输入内容",minlength:"10",maxlength:"255","show-word-limit":""},model:{value:e.user.userremark,callback:function(t){e.$set(e.user,"userremark",t)},expression:"user.userremark"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addUserDialogForm=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddUser}},[e._v("确 定")])],1)],1)],1)},a=[],l=(i("4160"),i("a434"),i("159b"),{name:"SysUserrole",data:function(){var e=this,t=function(t,i,s){e.getRequest("/system/userrole/find?workid="+i).then((function(e){e?s(new Error("该用户已拥有账号!")):s()}))},i=function(t,i,s){e.getRequest("/user/check/username/"+i).then((function(e){e?s(new Error("用户名已存在!")):s()}))},s=function(t,i,s){""!==e.user.password&&e.$refs.userForm.validateField("checkPassword"),s()},a=function(t,i,s){i!==e.user.password?s(new Error("两次输入密码不一致!")):s()};return{keywords:null,page:1,size:8,total:0,users:[],selectedRoles:[],allroles:[],addUserDialogForm:!1,employees:[],user:{workid:"1",username:"test",password:"123456789",checkPassword:"1234567890",userface:"http://bpic.588ku.com/element_pic/01/40/00/64573ce2edc0728.jpg",enabled:1,userremark:"test"},rules:{workid:[{required:!0,message:"请输入工号",trigger:"blur"},{validator:t,trigger:"blur"}],username:[{required:!0,message:"请输入账户名",trigger:"blur"},{validator:i,trigger:"blur"}],password:[{required:!0,message:"请输入账户密码",trigger:"blur"},{validator:s,trigger:"blur"}],checkPassword:[{required:!0,message:"请再次输入账户密码",trigger:"blur"},{validator:a,trigger:"blur"}],enabled:[{required:!0,message:"请选择账户状态",trigger:"change"}],userremark:[{required:!0,message:"请输入账户备注",trigger:"blur"}]}}},mounted:function(){this.initUsers(),this.initData()},methods:{emptyUser:function(){this.user={workid:"",username:"",password:"",checkPassword:"",userface:"http://bpic.588ku.com/element_pic/01/40/00/64573ce2edc0728.jpg",enabled:0,userremark:""}},addUser:function(){this.emptyUser(),this.addUserDialogForm=!0,this.$refs["userForm"].resetFields()},confirmAddUser:function(){var e=this;this.$refs["userForm"].validate((function(t){t&&e.postRequest("/system/userrole/user/",e.user).then((function(t){t&&(e.addUserDialogForm=!1,e.initUsers())}))}))},deleteUser:function(e){var t=this;this.$confirm("此操作将永久删除【"+e.employee.empname+"】, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRequest("/system/userrole/"+e.userid).then((function(e){e&&t.initUsers()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},doSearch:function(){this.initUsers()},hidePop:function(e){var t=this,i=[];Object.assign(i,e.roles);var s=!1;if(i.length!=this.selectedRoles.length)s=!0;else{for(var a=0;a<i.length;a++)for(var l=i[a],n=0;n<this.selectedRoles.length;n++){var o=this.selectedRoles[n];if(l.roleid==o){i.splice(a,1),a--;break}}0!=i.length&&(s=!0)}if(s){var r="/system/userrole/role?userid="+e.userid;this.selectedRoles.forEach((function(e){r+="&roleids="+e})),this.putRequest(r).then((function(e){e&&t.initUsers()}))}},showPop:function(e){var t=this;this.initAllRoles();var i=e.roles;this.selectedRoles=[],i.forEach((function(e){t.selectedRoles.push(e.roleid)}))},resetpw:function(e){var t=this;e.password="$2a$10$ySG2lkvjFHY5O0./CPIE1OI8VJsuKYEzOYzqIa7AJR6sEgSzUFOAm",this.putRequest("/system/userrole/",e).then((function(e){e&&t.initUsers()}))},enabledChange:function(e){var t=this;delete e.roles,this.putRequest("/system/userrole/",e).then((function(e){e&&t.initUsers()}))},initAllRoles:function(){var e=this;this.getRequest("/system/userrole/roles").then((function(t){t&&(e.allroles=t)}))},initUsers:function(){var e=this,t="/system/userrole/?page="+this.page+"&size="+this.size;this.keywords&&(t+="&keywords="+this.keywords),this.getRequest(t).then((function(t){t&&(e.users=t.data,e.total=t.total,0===t.data.length&&e.$notify.error({title:"错误",message:"本页没有数据，请翻页或添加数据！"}))}))},initData:function(){var e=this;window.sessionStorage.getItem("emps")?this.employees=JSON.parse(window.sessionStorage.getItem("emps")):this.getRequest("/organization/management/employee/").then((function(t){t&&(e.employees=t,window.sessionStorage.setItem("emps",JSON.stringify(t)))}))},sizeChange:function(e){this.size=e,this.initUsers()},currentChange:function(e){this.page=e,this.initUsers()}}}),n=l,o=(i("d06d"),i("2877")),r=Object(o["a"])(n,s,a,!1,null,"6aaa4ca5",null);t["default"]=r.exports},"864e":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%"}},[i("div",[i("div",{staticClass:"top-menu"},[i("div",[e._v(" 所属部门: "),i("el-popover",{attrs:{placement:"right",title:"请选择部门",width:"200",trigger:"manual"},model:{value:e.searchDepView,callback:function(t){e.searchDepView=t},expression:"searchDepView"}},[i("el-tree",{attrs:{"default-expand-all":"",data:e.allDeps,props:e.defaultProps},on:{"node-click":e.searvhViewHandleNodeClick}}),i("div",{staticClass:"select-dep",attrs:{slot:"reference"},on:{click:e.showSearchDepView},slot:"reference"},[e._v(e._s(e.inputDepName)+" ")])],1),e._v(" 操作时间: "),i("el-date-picker",{staticStyle:{width:"340px"},attrs:{type:"datetimerange","unlink-panels":"",align:"right","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","range-separator":"至","end-placeholder":"结束日期","default-time":["09:00:00","18:00:00"]},model:{value:e.searchValue.logtime,callback:function(t){e.$set(e.searchValue,"logtime",t)},expression:"searchValue.logtime"}}),i("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入员工名进行搜索，可以直接回车搜索...","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.initSystemlog},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.initSystemlog(t)}},model:{value:e.searchValue.empname,callback:function(t){e.$set(e.searchValue,"empname",t)},expression:"searchValue.empname"}}),i("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.initSystemlog}},[e._v(" 搜索 ")])],1),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.batchDeleteSystemlog}},[e._v("批量删除日志")])],1)]),i("div",{staticStyle:{"margin-top":"10px"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.systemlogLoading,expression:"systemlogLoading"}],ref:"multipleTable",attrs:{stripe:"",border:"","max-height":"513",data:e.systemlogs,"element-loading-text":"正在加载...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),i("el-table-column",{attrs:{"header-align":"center",fixed:"",prop:"syslogid",label:"编号",align:"left",width:"85"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"employee.empname",fixed:"",align:"left",label:"姓名",width:"90"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"workid",label:"工号",align:"left",width:"85"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"department.depname",width:"100",align:"left",label:"所属部门"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"broswer",width:"100",align:"left",label:"浏览器类型"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"version",width:"110",align:"left",label:"浏览器版本"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"ip",width:"100",align:"left",label:"操作IP地址"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"","header-align":"center",prop:"description",width:"150",align:"left",label:"日志描述"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"","header-align":"center",prop:"logcontent",width:"330",align:"left",label:"日志内容"}}),i("el-table-column",{attrs:{"header-align":"center",prop:"logtime",width:"140",align:"left",label:"操作时间"}}),i("el-table-column",{attrs:{align:"center",fixed:"right",width:"80px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{color:"#15aabf"},attrs:{type:"text"},on:{click:function(i){return e.checkSystemlog(t.row)}}},[i("i",{staticClass:"fas fa-eye fa-lg"})])]}}])})],1)],1),i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next, jumper, ->, total, slot",total:e.total},on:{"current-change":e.currentChange,"size-change":e.sizeChange}})],1),i("el-dialog",{attrs:{title:"查看日志",visible:e.systemlogDialog,width:"50%"},on:{"update:visible":function(t){e.systemlogDialog=t}}},[i("div",[i("el-form",{attrs:{model:e.systemlog,disabled:"","label-position":"left","label-width":"100px"}},[i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"员工工号:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.workid,callback:function(t){e.$set(e.systemlog,"workid",t)},expression:"systemlog.workid"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"员工姓名:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.employee.empname,callback:function(t){e.$set(e.systemlog.employee,"empname",t)},expression:"systemlog.employee.empname"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"所属部门:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.department.depname,callback:function(t){e.$set(e.systemlog.department,"depname",t)},expression:"systemlog.department.depname"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"浏览器类型:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.broswer,callback:function(t){e.$set(e.systemlog,"broswer",t)},expression:"systemlog.broswer"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"浏览器版本:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.version,callback:function(t){e.$set(e.systemlog,"version",t)},expression:"systemlog.version"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"操作IP:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.ip,callback:function(t){e.$set(e.systemlog,"ip",t)},expression:"systemlog.ip"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"操作时间:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.logtime,callback:function(t){e.$set(e.systemlog,"logtime",t)},expression:"systemlog.logtime"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"日志描述:"}},[i("el-input",{staticStyle:{width:"90%"},attrs:{size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.description,callback:function(t){e.$set(e.systemlog,"description",t)},expression:"systemlog.description"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"日志内容:"}},[i("el-input",{staticStyle:{width:"95%"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:6},size:"mini","prefix-icon":"el-icon-edit"},model:{value:e.systemlog.logcontent,callback:function(t){e.$set(e.systemlog,"logcontent",t)},expression:"systemlog.logcontent"}})],1)],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"info"},on:{click:function(t){e.systemlogDialog=!1}}},[e._v("确 定")])],1)])],1)},a=[],l={name:"SysLog",data:function(){return{searchValue:{empname:null,depid:null,logtime:null},page:1,size:10,total:0,searchDepView:!1,systemlogLoading:!1,systemlogDialog:!1,inputDepName:"所属部门",allDeps:[],systemlogs:[],multipleSelection:[],systemlog:{employee:{},department:{}},defaultProps:{children:"children",label:"depname"}}},mounted:function(){this.initSystemlog(),this.initData()},methods:{initSystemlog:function(){var e=this;this.systemlogLoading=!0;var t="/system/log/?page="+this.page+"&size="+this.size;this.searchValue.empname&&(t+="&empname="+this.searchValue.empname),this.searchValue.depid&&(t+="&depid="+this.searchValue.depid),this.searchValue.logtime&&(t+="&logtime="+this.searchValue.logtime),this.getRequest(t).then((function(t){e.systemlogLoading=!1,t&&(e.systemlogs=t.data,e.total=t.total,0===t.data.length&&e.$notify.error({title:"错误",message:"历史记录中没有数据，请翻页或添加数据！"}))}))},initData:function(){var e=this;window.sessionStorage.getItem("deps")?this.allDeps=JSON.parse(window.sessionStorage.getItem("deps")):this.getRequest("/employee/basic/info/deps").then((function(t){t&&(e.allDeps=t,window.sessionStorage.setItem("deps",JSON.stringify(t)))}))},batchDeleteSystemlog:function(){var e=this;this.$confirm("此操作将永久删除所选中的所有日志, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.postRequest("/system/log/deletesystemlogs/",e.multipleSelection).then((function(t){t&&e.initSystemlog()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},checkSystemlog:function(e){this.systemlog=e,this.systemlogDialog=!0},sizeChange:function(e){this.size=e,this.initSystemlog()},currentChange:function(e){this.page=e,this.initSystemlog()},searvhViewHandleNodeClick:function(e){this.inputDepName=e.depname,this.searchValue.depid=e.depid,this.searchDepView=!this.searchDepView},showSearchDepView:function(){this.searchDepView=!this.searchDepView},handleSelectionChange:function(e){this.multipleSelection=e}}},n=l,o=(i("f108"),i("2877")),r=Object(o["a"])(n,s,a,!1,null,"79a04bd6",null);t["default"]=r.exports},b110:function(e,t,i){"use strict";var s=i("63a5"),a=i.n(s);a.a},bf1f:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"500px"}},[i("el-input",{attrs:{placeholder:"请输入部门名称进行搜索...","prefix-icon":"el-icon-search"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),i("div",{staticClass:"organization-tree"},[i("el-tree",{ref:"tree",attrs:{data:e.deps,props:e.defaultProps,"expand-on-click-node":!1,"filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var s=t.data;return i("span",{staticClass:"custom-tree-node",staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[i("span",[e._v(e._s(s.depname)+"(领导: "+e._s(s.leadername)+")")]),i("span",[i("el-button",{staticClass:"depBtn",attrs:{type:"info",size:"mini"},on:{click:function(){return e.showUpdateDepView(s)}}},[e._v(" 修改 ")]),i("el-button",{staticClass:"depBtn",attrs:{type:"primary",size:"mini"},on:{click:function(){return e.showAddDepView(s)}}},[e._v(" 添加 ")]),i("el-button",{staticClass:"depBtn",attrs:{type:"danger",size:"mini"},on:{click:function(){return e.deleteDep(s)}}},[e._v(" 删除 ")])],1)])}}])}),i("el-dialog",{attrs:{title:"修改部门",visible:e.updateDialogVisible,width:"30%"},on:{"update:visible":function(t){e.updateDialogVisible=t}}},[i("div",[i("table",[i("tr",[i("td",[i("el-tag",[e._v("部门名称")])],1),i("td",[i("el-input",{attrs:{placeholder:"请输入部门名称..."},model:{value:e.dep.depname,callback:function(t){e.$set(e.dep,"depname",t)},expression:"dep.depname"}})],1)]),i("tr",[i("td",[i("el-tag",[e._v("领导工号")])],1),i("td",[i("el-select",{staticClass:"findAllEmp-autocomplete",attrs:{"popper-append-to-body":!1,clearable:"",filterable:"",placeholder:"请选择领导姓名"},model:{value:e.dep.leaderid,callback:function(t){e.$set(e.dep,"leaderid",t)},expression:"dep.leaderid"}},e._l(e.employees,(function(t){return i("el-option",{key:t.workid,attrs:{label:t.label,value:t.workid}},[i("div",{staticClass:"empname"},[e._v(e._s(t.label))]),i("span",{staticClass:"workid"},[e._v("工号: "+e._s(t.workid))])])})),1)],1)])])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.updateDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.doUpdateDep}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"添加部门",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[i("div",[i("table",[i("tr",[i("td",[i("el-tag",[e._v("上级部门")])],1),i("td",[e._v(e._s(e.pname))])]),i("tr",[i("td",[i("el-tag",[e._v("部门名称")])],1),i("td",[i("el-input",{attrs:{placeholder:"请输入部门名称..."},model:{value:e.dep.depname,callback:function(t){e.$set(e.dep,"depname",t)},expression:"dep.depname"}})],1)]),i("tr",[i("td",[i("el-tag",[e._v("领导姓名")])],1),i("td",[i("el-select",{staticClass:"findAllEmp-autocomplete",attrs:{"popper-append-to-body":!1,clearable:"",filterable:"",placeholder:"请选择领导姓名"},model:{value:e.dep.leaderid,callback:function(t){e.$set(e.dep,"leaderid",t)},expression:"dep.leaderid"}},e._l(e.employees,(function(t){return i("el-option",{key:t.workid,attrs:{label:t.label,value:t.workid}},[i("div",{staticClass:"empname"},[e._v(e._s(t.label))]),i("span",{staticClass:"workid"},[e._v("工号: "+e._s(t.workid))])])})),1)],1)])])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.doAddDep}},[e._v("确 定")])],1)])],1)],1)},a=[],l=(i("99af"),i("4de4"),i("c975"),i("a434"),{name:"OrgManage",data:function(){return{addDialogVisible:!1,updateDialogVisible:!1,filterText:"",dep:{depname:"",parentid:-1},pname:"",deps:[],defaultProps:{children:"children",label:"depname"},employees:[],state:""}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){this.initDeps()},methods:{initDep:function(){this.dep={depname:"",parentid:-1},this.pname=""},updateDep2Deps:function(e,t){for(var i=0;i<e.length;i++){var s=e[i];if(s.depid==t.depid)return void(s.leadername=t.leadername);this.updateDep2Deps(s.children,t)}},doUpdateDep:function(){var e=this;this.putRequest("/organization/management/update/",this.dep).then((function(t){t&&(e.updateDep2Deps(e.deps,t.obj),e.updateDialogVisible=!1,e.initDep())}))},addDep2Deps:function(e,t){for(var i=0;i<e.length;i++){var s=e[i];if(s.depid==t.parentid)return s.children=s.children.concat(t),void(s.children.length>0&&(s.parent=!0));this.addDep2Deps(s.children,t)}},doAddDep:function(){var e=this;this.postRequest("/organization/management/",this.dep).then((function(t){t&&(e.addDep2Deps(e.deps,t.obj),e.addDialogVisible=!1,e.initDep())}))},removeDepFromDeps:function(e,t,i){for(var s=0;s<t.length;s++){var a=t[s];if(a.depid==i)return t.splice(s,1),void(0==t.length&&(e.parent=!1));this.removeDepFromDeps(a,a.children,i)}},deleteDep:function(e){var t=this;e.parent?this.$message.error("父部门删除失败"):this.$confirm("此操作将永久删除【"+e.depname+"】部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.deleteRequest("/organization/management/"+e.depid).then((function(i){i&&t.removeDepFromDeps(null,t.deps,e.depid)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},showUpdateDepView:function(e){this.dep.depid=e.depid,this.dep.depname=e.depname,this.dep.parentid=e.parentid,this.updateDialogVisible=!0},showAddDepView:function(e){this.pname=e.depname,this.dep.parentid=e.depid,this.addDialogVisible=!0},initDeps:function(){var e=this;this.getRequest("/organization/management/").then((function(t){t&&(e.deps=t)})),this.getRequest("/organization/management/employee/").then((function(t){t&&(e.employees=t)}))},filterNode:function(e,t){return!e||-1!==t.depname.indexOf(e)}}}),n=l,o=(i("c6c1"),i("2877")),r=Object(o["a"])(n,s,a,!1,null,"6df43939",null);t["default"]=r.exports},c6c1:function(e,t,i){"use strict";var s=i("cca2"),a=i.n(s);a.a},cca2:function(e,t,i){},d06d:function(e,t,i){"use strict";var s=i("e81d0"),a=i.n(s);a.a},da38:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.globalLoading,expression:"globalLoading"}],attrs:{"element-loading-text":"正在添加...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("div",{staticClass:"permissManaTool"},[i("el-input",{attrs:{size:"small",placeholder:"请输入角色英文名"},model:{value:e.role.enname,callback:function(t){e.$set(e.role,"enname",t)},expression:"role.enname"}},[i("template",{slot:"prepend"},[e._v("ROLE_")])],2),i("el-input",{attrs:{size:"small",placeholder:"请输入角色中文名"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doAddRole(t)}},model:{value:e.role.zhname,callback:function(t){e.$set(e.role,"zhname",t)},expression:"role.zhname"}}),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.doAddRole}},[e._v("添加角色")])],1),i("div",{staticClass:"permissManaMain"},[i("el-collapse",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"正在加载...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",accordion:""},on:{change:e.change},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.roles,(function(t,s){return i("el-collapse-item",{key:s,attrs:{title:t.zhname,name:t.roleid}},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("可访问的资源")]),i("el-button",{staticStyle:{float:"right",padding:"3px 0",color:"#ff0000"},attrs:{icon:"el-icon-delete",type:"text"},on:{click:function(i){return e.deleteRole(t)}}})],1),i("div",[i("el-tree",{key:s,ref:"tree",refInFor:!0,attrs:{"show-checkbox":"","node-key":"pid","default-checked-keys":e.selectedPermissions,data:e.allpermissions,props:e.defaultProps}}),i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("el-button",{on:{click:e.cancelUpdate}},[e._v("取消修改")]),i("el-button",{attrs:{type:"primary"},on:{click:function(i){return e.doUpdate(t.roleid,s)}}},[e._v("确认修改")])],1)],1)])],1)})),1),i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next, jumper, ->, total, slot",total:e.total},on:{"current-change":e.currentChange,"size-change":e.sizeChange}})],1)],1)])},a=[],l=(i("4160"),i("159b"),{name:"SysRolep",data:function(){return{role:{enname:"",zhname:""},allpermissions:[],selectedPermissions:[],activeName:-1,roles:[],page:1,size:10,total:0,loading:!1,globalLoading:!1,defaultProps:{children:"children",label:"name"}}},mounted:function(){this.initRoles()},methods:{deleteRole:function(e){var t=this;this.$confirm("此操作将永久删除【"+e.zhname+"】角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.globalLoading=!0,t.deleteRequest("/system/rolepermission/role/"+e.roleid).then((function(e){t.globalLoading=!1,e&&(t.page=1,t.initRoles())}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},doAddRole:function(){var e=this;this.role.enname&&this.role.zhname?(this.globalLoading=!0,this.postRequest("/system/rolepermission/role",this.role).then((function(t){e.globalLoading=!1,t&&(e.role.enname="",e.role.zhname="",e.initRoles())}))):this.$message.error("数据不可以为空")},cancelUpdate:function(){this.activeName=-1},doUpdate:function(e,t){var i=this,s=this.$refs.tree[t],a=s.getCheckedKeys(!0),l="/system/rolepermission/?roleid="+e;a.forEach((function(e){l+="&pids="+e})),this.putRequest(l).then((function(e){e&&(i.activeName=-1)}))},change:function(e){e&&(this.initAllPermissions(),this.initSelectedPermissions(e))},initSelectedPermissions:function(e){var t=this;this.getRequest("/system/rolepermission/pids/"+e).then((function(e){e&&(t.selectedPermissions=e)}))},initAllPermissions:function(){var e=this;this.getRequest("/system/rolepermission/permissions").then((function(t){t&&(e.allpermissions=t)}))},sizeChange:function(e){this.size=e,this.initRoles()},currentChange:function(e){this.page=e,this.initRoles()},initRoles:function(){var e=this;this.loading=!0;var t="/system/rolepermission/?page="+this.page+"&size="+this.size;this.getRequest(t).then((function(t){e.loading=!1,t&&(e.roles=t.data,e.total=t.total,0===t.data.length&&e.$notify.error({title:"错误",message:"本页没有数据，请翻页或添加数据！"}))}))}}}),n=l,o=(i("b110"),i("2877")),r=Object(o["a"])(n,s,a,!1,null,"1da94cd8",null);t["default"]=r.exports},e81d0:function(e,t,i){},ef0a:function(e,t,i){},f108:function(e,t,i){"use strict";var s=i("ef0a"),a=i.n(s);a.a},feca:function(e,t,i){var s={"./Home.vue":"bb51","./Login.vue":"a55b","./UserInfo.vue":"ee96","./att/AttManaOfDay.vue":"3c55","./att/AttManaOfMon.vue":"0612","./att/AttTraapp.vue":"11ee","./att/AttTramanagement.vue":"628f","./att/AttTransactioninfo.vue":"c5cd","./att/AttWs.vue":"587e","./emp/EmpBasic.vue":"58da","./org/OrgManage.vue":"bf1f","./sal/SalCheck.vue":"9c6a","./sal/SalEmp.vue":"eeb6","./sal/SalInfo.vue":"6c55","./sal/SalSad.vue":"18c2","./sal/SalScheme.vue":"c508","./sal/SalTr.vue":"a0c2","./sal/SalTreatment.vue":"ed02","./sal/SalWelfare.vue":"fb2d","./sys/SysLog.vue":"864e","./sys/SysRolep.vue":"da38","./sys/SysUserrole.vue":"7dcb","./work/WorkBench.vue":"2757"};function a(e){var t=l(e);return i(t)}function l(e){if(!i.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=l,e.exports=a,a.id="feca"}}]);
//# sourceMappingURL=chunk-e83db30a.bfde396d.js.map